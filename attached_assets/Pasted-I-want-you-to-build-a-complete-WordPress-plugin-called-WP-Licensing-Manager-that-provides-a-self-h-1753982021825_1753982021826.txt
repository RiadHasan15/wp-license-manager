I want you to build a complete WordPress plugin called “WP Licensing Manager” that provides a self‑hosted licensing system for my premium WordPress plugins/themes.

The plugin must:

    Fully follow WordPress.org plugin development guidelines.

    Be GPL‑compatible.

    Use WordPress Coding Standards (PHPCS).

    Use proper sanitization (sanitize_text_field, esc_html, etc.).

    Protect against SQL injection ($wpdb->prepare()), CSRF (nonces), and XSS.

    Use wp_enqueue_script and wp_enqueue_style for assets.

    All API calls must be HTTPS.

1. Multi‑Product Licensing

    Support unlimited products (plugins/themes) in one system.

    Each license is linked to a specific product.

    Admin can manage products, licenses, and activations separately.

2. WooCommerce Integration

    Add a product meta checkbox _is_licensed in WooCommerce products.

    When an order is completed:

        If the product is licensed:

            Generate a unique 32‑character license key.

            Save license data in the database:

                Product ID & slug

                Status (active, inactive, expired)

                Expiration date (default: 1 year)

                Max activations (default: 1)

                Current activations (0 initially)

                Domains activated (empty initially)

                Customer email & WooCommerce order ID

            Email the license key to the customer.

            Show license in My Account → My Licenses tab.

3. Database Schema

Create three custom database tables with $wpdb->prefix:

Table 1: Licenses (wp_licenses)
Field	Type	Notes
id	BIGINT AUTO_INCREMENT	Primary key
product_id	BIGINT	Linked to product table
license_key	VARCHAR(64) UNIQUE	Generated key
status	ENUM('active','inactive','expired')	Default: active
expires_at	DATE	NULL = lifetime
max_activations	INT	Default: 1
activations	INT	Default: 0
domains	TEXT	Comma‑separated
customer_email	VARCHAR(255)	WooCommerce email
order_id	BIGINT	WooCommerce order ID
created_at	TIMESTAMP	Default CURRENT_TIMESTAMP

Table 2: Activations (wp_license_activations)
Field	Type	Notes
id	BIGINT AUTO_INCREMENT	Primary key
license_id	BIGINT	Linked to licenses table
product_id	BIGINT	Linked to products table
domain	VARCHAR(255)	Activated domain
ip_address	VARCHAR(45)	Optional
activated_at	TIMESTAMP	Default CURRENT_TIMESTAMP

Table 3: Products (wp_license_products)
Field	Type	Notes
id	BIGINT AUTO_INCREMENT	Primary key
slug	VARCHAR(100) UNIQUE	Product identifier
name	VARCHAR(255)	Product display name
latest_version	VARCHAR(20)	Latest version number
changelog	TEXT	Changelog text
update_file_path	VARCHAR(255)	Path to ZIP file for updates
4. REST API (JSON)

Namespace: /wp-json/licensing/v1/
Endpoints:

    /validate → Validate license for a product.

    /activate → Bind license to domain & increment activation count.

    /deactivate → Remove activation for a domain.

    /update-check → Return version, changelog, and download URL if license is valid.

    /update-download → Deliver plugin/theme ZIP only if license is valid.

    /stats (admin only) → Return analytics for activations and updates.

Rules:

    Require license_key for all requests.

    Require product_id or product_slug for multi‑product support.

    Require domain for activate/deactivate calls.

    Responses must be JSON with clear status values.

5. Automatic Plugin Updates (Licensed Users Only)

    Store each product’s latest version and ZIP in /updates/{product-slug}/.

    /update-check returns update data only if license is valid.

    /update-download serves file only if license is valid.

    Provide integration snippet for premium plugin:

        License entry form in settings.

        Validate license before enabling updates.

        Override WP update system to use /update-check and /update-download.

6. Activation Tracking

    Track each activation in wp_license_activations.

    Block activations if max limit reached.

    Allow deactivation via API.

7. Admin Dashboard

Menu: Licensing Manager with:

    Licenses → List/search/edit/delete licenses.

    Products → Add/edit products, set latest version, changelog, upload update ZIP.

    Analytics →

        Activations per product (chart).

        Update checks per product (chart).

        Most active domains table.

    Settings → Global defaults (expiry, activation limit, email templates).

8. Analytics Dashboard

    Show activation trends over time per product.

    Show update check frequency per product.

    Show most active domains.

    Track downloads served per product.

9. Folder Structure

wp-licensing-manager/
├── wp-licensing-manager.php        # Main plugin file
├── includes/
│   ├── class-license-manager.php   # Core license handling
│   ├── class-product-manager.php   # Product management
│   ├── class-activation-manager.php# Activation tracking
│   ├── class-api.php               # REST API endpoints
│   ├── class-woocommerce.php       # WooCommerce integration
│   ├── class-updates.php           # Update handling
│   └── helpers.php                 # Sanitization & utility functions
├── admin/
│   ├── views/                      # Admin page templates
│   ├── class-admin-menu.php        # Admin menu & pages
│   └── css/
│       └── admin.css
├── assets/
│   ├── css/
│   │   └── style.css
│   ├── js/
│   │   └── admin.js
├── updates/                        # Holds update ZIP files per product
│   └── example-plugin.zip
└── uninstall.php                   # Clean DB on uninstall

10. Security

    HTTPS enforced for all API calls.

    Random, unpredictable license keys.

    Domain binding optional.

    Rate limit failed API requests.

    All queries prepared with $wpdb->prepare().

    Nonces for all form submissions.

11. Deliverables

    Fully working WordPress plugin (PHP) with all above features.

    GPL‑compatible, WordPress.org‑compliant code.

    Works with latest WooCommerce & WordPress.

    Integration code snippet for my premium plugin to:

        Validate license.

        Activate/deactivate license.

        Enable automatic updates.

    Documentation for installation, setup, and integration.

Build this plugin so I can install it on my WordPress site, activate it, and immediately sell and manage licenses for multiple products with WooCommerce, protect my premium plugins, and deliver automatic updates only to licensed customers. It must be clean, secure, and expandable.